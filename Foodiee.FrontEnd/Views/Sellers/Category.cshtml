@model CategoryDTO;
<style type="text/css">
    .card
    {
        width:70%;
        margin:0px 15% 0px 15%;
        border:1px solid lightgray;
        border-radius:10px;
    }

    .Heading{
        font-size:28px;
        font-weight:600;
        color:white;
    }
    .card-header{
        background-color: #0f0c29;
        border-radius:10px 10px 0px 0px !important;
    }
</style>
<script type="text/javascript">
    $(function () {
        $('.form-control').attr("autocomplete", "off");

        $('.btnsave').click(function (event) {
           return FileValidation();
           
        });

        $('.Files').change(function () {
            debugger
            var fileInput = $(this)[0].files[0];
            var formData = new FormData();
            formData.append('CategoryImage', fileInput);

            var res = FileValidation();
            if (res == true) {
                $.ajax({
                    type:"POST",
                    url: "@Url.Action("SaveFile", "Sellers")",
                    data:formData,
                    processData: false,
                    contentType: false,
                    success:function(data)
                    {
                        debugger
                        if (data != "" && data!= null) {
                            $('.CategoryImg').attr('src', data);
                        }
                    },
                    error:function(data)
                    {
                        alert("Error Occured");
                    }
            });                
            }
          
            $('.btnclear').click(function () {
                $('#CategoryName').val("");
                $('#CategoryDesc').val("");
                $('.Files').val("");
                $('.CategoryImg').attr("src", "  https://www.legrand.com.kh/modules/custom/legrand_ecat/assets/img/no-image.png");
                return false;
            });
        });

        function FileValidation(){
            debugger;

            // Use jQuery to get the file input element
            var fileInput = $('.Files')[0].files[0];
            var MaxSize = 1 * 1024 * 1024;
            var errordoc = document.querySelector('span[data-valmsg-for="CategoryDetails.CategoryImageURL"]');

            if (fileInput.size > MaxSize) {
                errordoc.textContent='File Size Should Be Less Than 10MB';
                $('.Files').val();
                return false;
            }
            else {
                errordoc.textContent="";
                return true;
            }
        }
    
    });
    

</script>
<div class="container-fluid">
    <form asp-action="Category" method="post" enctype="multipart/form-data">
    <div class="card">
        <div class="card-header text-center">
            <h4 class="display-3 Heading" >Add New Category</h4>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-lg-9">
                    <div class="row">
                        <div class="col-lg-12">
                            <label asp-for="CategoryDetails.CategoryName" class="form-label"></label><em class="text-danger"> * </em>:
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <input asp-for="CategoryDetails.CategoryName" class="form-control" id="CategoryName" />
                            <span class="error" asp-validation-for="CategoryDetails.CategoryName"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <label class="form-label" asp-for="CategoryDetails.CategoryDesc"></label><em class="text-danger"> * </em>:
                        </div>
                    </div>
                    <div class="row">
                    <div class="col-lg-12">
                        <textarea asp-for="CategoryDetails.CategoryDesc" class="form-control" id="CategoryDesc"></textarea>
                        <span class="error" asp-validation-for="CategoryDetails.CategoryDesc"></span>
                    </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <label class="form-label" asp-for="CategoryDetails.CategoryImageURL"></label><em class="text-danger"> * </em>:
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <input type="file" name="CategoryImage"  asp-for="CategoryDetails.CategoryImageURL" class="form-control Files" />
                            <span class="error docerror" asp-validation-for="CategoryDetails.CategoryImageURL"></span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3">
                        <img class="mt-2 shadow-sm CategoryImg"  src="https://www.legrand.com.kh/modules/custom/legrand_ecat/assets/img/no-image.png" alt="" style="width:100%;height:95%;border:1px solid white;border-radius:10px;" />
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-lg-10 text-center">
                    <button type="button" class="btn btn-secondary col-lg-2">Back</button>
                    <button type="submit" class="btn btn-primary col-lg-2 btnsave">Save</button>
                    <button type="reset" class="btn btn-primary col-lg-2 btnclear">Clear</button>
                </div>
            </div>
        </div>
    </div>
    </form>
</div>
@section Scripts{
    <partial name="_ValidationScriptsPartial"></partial>
}